Names_Raw <- names(Mad_RAW)
Names_Raw[c(1,2,3,4,5,6,7,10,11,12,13,14,15,16,17,,18,19)]
Names_Raw[1]
Names_Raw[1,2]
Names_Raw[c(1,2)]
Mad_selected <- Mad_RAW %>%
secelct(Species, Year, Month, Total_length_mm, Total_length_class_mm,
`Mature/Imature`,Sampling_site, Protective_regime, Proximity_human_settlements,
Accessibility, Age_Lt,`Age months`, `Age class`)
#Libreries
library(readxl)
library(tidyverse)
library(flextable)
library(moments)
library(DescTools)
library(magrittr)
library(moderndive)
library(gridExtra)
library(car)
library(multcomp)
library(janitor)
library(magrittr)
library(ggplot2)
library(ggthemes)
library(lmtest)
library(conover.test)
library(pROC)
library(hrbrthemes)
library(viridis)
library(ggridges)
library(descr)
library(effsize)
library(vcd)
#Databases
Mad_RAW <- read_excel("Madeira/BD_LIMPETS_MAD_1996-2018.xlsx",
sheet = "Data", range = "A1:T69707")
Mad_selected <- Mad_RAW %>%
secelct(Species, Year, Month, Total_length_mm, Total_length_class_mm,
`Mature/Imature`,Sampling_site, Protective_regime, Proximity_human_settlements,
Accessibility, Age_Lt,`Age months`, `Age class`)
Mad_selected <- Mad_RAW %>%
select(Species, Year, Month, Total_length_mm, Total_length_class_mm,
`Mature/Imature`,Sampling_site, Protective_regime, Proximity_human_settlements,
Accessibility, Age_Lt,`Age months`, `Age class`)
Mad_selected <- Mad_RAW %>%
select(Species, Year, Month, Total_length_mm, Total_length_class_mm,...
`Mature/Imature`,Sampling_site, Protective_regime, Proximity_human_settlements,...
Mad_selected <- Mad_RAW %>%
select(Species, Year, Month, Total_length_mm, Total_length_class_mm, `Mature/Imature`,Sampling_site, Protective_regime, Proximity_human_settlements, Accessibility, Age_Lt,`Age months`, `Age class`)
Mad_selected <- Mad_RAW %>%
select(Species, Year, Month, Total_length_mm, Total_length_class_mm,
"Mature/Imature",Sampling_site, Protective_regime, Proximity_human_settlements,
Accessibility, Age_Lt,"Age months", "Age class")
library(janitor)
Mad_RAW_Clean <- Mad_RAW %>% clean_names()
names(Mad_RAW)
names(Mad_RAW,Mad_RAW_Clean)
names(c(Mad_RAW,Mad_RAW_Clean)
names(c(Mad_RAW,Mad_RAW_Clean))
names([Mad_RAW,Mad_RAW_Clean])
names(Mad_RAW_Clean)
Mad_selected <- Mad_RAW_Clean %>%
select(species, year, month, total_length_mm, total_length_class_mm,
mature_immature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class)
Mad_selected <- Mad_RAW_Clean %>%
select(species, year, month, total_length_mm, total_length_class_mm,
mature_immature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class)
Mad_RAW_Clean <- Mad_RAW %>% clean_names() #Arregla el formato de los nombre de las variables
Mad_selected <- Mad_RAW_Clean %>%
select(any_of(c("species", "year", "month", "total_length_mm", "total_length_class_mm",
"mature_immature", "sampling_site", "protective_regime",
"proximity_human_settlements", "accessibility",
"age_lt", "age_months", "age_class")))
names(Mad_RAW_Clean)
Mad_selected <- Mad_RAW_Clean %>%
select(species, year, month, total_length_mm, total_length_class_mm,
mature_immature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class)
Mad_selected <- Mad_RAW_Clean %>%
select(species, year, month, total_length_mm, total_length_class_mm,
mature_imature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class)
Mad_selected <- Mad_RAW_Clean %>%
select(species, year, month, total_length_mm, total_length_class_mm,
mature_imature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class)
Mad_RAW_Clean <- Mad_RAW %>% clean_names() #Arregla el formato de los nombre de las variables
#Databases
Mad_RAW <- read_excel("Madeira/BD_LIMPETS_MAD_1996-2018.xlsx",
sheet = "Data", range = "A1:T69707")
gc()
#Databases
Mad_RAW <- read_excel("Madeira/BD_LIMPETS_MAD_1996-2018.xlsx",
sheet = "Data", range = "A1:T69707")
Mad_RAW_Clean <- Mad_RAW %>% clean_names() #Arregla el formato de los nombre de las variables
names(Mad_RAW_Clean)
Mad_selected <- Mad_RAW_Clean %>%
select(species, year, month, total_length_mm, total_length_class_mm,
mature_imature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class)
Mad_selected <- dplyr::select(Mad_RAW_Clean,
species, year, month, total_length_mm, total_length_class_mm,
mature_imature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class)
summary(Mad_selected)
Mad_selected <- Mad_selected %>%
mutate(across(where(is.character), as.factor))
Mad_selected <- dplyr::select(Mad_RAW_Clean,
species, year, month, total_length_mm, total_length_class_mm,
mature_imature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class) %>%
mutate(across(where(is.character), as.factor))
summary(Mad_selected)
Mad_2sp <- Mad_selected %>%
filter(species %in% c("Patella ordinaria", "Patella aspera"))
ggplot(Mad_2sp, aes(x = species, y = total_length_mm)) +
geom_boxplot() +
theme_minimal()
View(Mad_2sp)
#Databases
Mad_RAW <- read_excel("Madeira/BD_LIMPETS_MAD_1996-2018.xlsx",
sheet = "Data", range = "A1:T69707")
Mad_RAW_Clean <- Mad_RAW %>% clean_names() #Arregla el formato de los nombre de las variables
names(Mad_RAW_Clean)
Mad_selected <- dplyr::select(Mad_RAW_Clean,
species, year, month, total_length_mm, total_length_class_mm,
mature_imature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class) %>%
mutate(across(where(is.character), as.factor))
summary(Mad_selected)
Mad_2sp <- Mad_selected %>%
filter(species %in% c("Patella ordinaria", "Patella aspera"))
ggplot(Mad_2sp, aes(x = species, y = total_length_mm)) +
geom_boxplot() +
theme_minimal()
Mad_selected <- dplyr::select(Mad_RAW_Clean,
species, year, month, total_length_mm, total_length_class_mm,
Weigth_g,mature_imature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class) %>%
mutate(across(where(is.character), as.factor))
summary(Mad_selected)
Mad_2sp <- Mad_selected %>%
filter(species %in% c("Patella ordinaria", "Patella aspera"))
Mad_2sp <- Mad_selected %>%
filter(species %in% c("Patella ordinaria", "Patella aspera"))
Mad_selected <- dplyr::select(Mad_RAW_Clean,
species, year, month, total_length_mm, total_length_class_mm,
Weigth_g,mature_imature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class) %>%
mutate(across(where(is.character), as.factor))
Mad_selected <- dplyr::select(Mad_RAW_Clean,
species, year, month, total_length_mm, total_length_class_mm,
Weight_g,mature_imature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class) %>%
mutate(across(where(is.character), as.factor))
names(Mad_RAW_Clean)
Mad_selected <- dplyr::select(Mad_RAW_Clean,
species, year, month, total_length_mm, total_length_class_mm,
weight_g,mature_imature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class) %>%
mutate(across(where(is.character), as.factor))
summary(Mad_selected)
Mad_2sp <- Mad_selected %>%
filter(species %in% c("Patella ordinaria", "Patella aspera"))
#Visualizacion de diferencia entre tallas
ggplot(Mad_2sp, aes(x = species, y = total_length_mm)) +
geom_boxplot() +
theme_minimal()
#Visualizacion de diferencia entre tallas
ggplot(Mad_2sp, aes(x = species, y = weight_g)) +
geom_boxplot() +
theme_minimal()
#Visualizacion de diferencia entre tallas
ggplot(Mad_2sp, aes(x = species, y = log10(weight_g))) +
geom_boxplot() +
theme_minimal()
#Visualizacion de diferencia entre tallas
ggplot(Mad_2sp, aes(x = species, y = log10(total_length_mm))) +
geom_boxplot() +
theme_minimal()
Mad_2sp <- Mad_selected %>%
filter(!is.na(sampling_site),species %in% c("Patella ordinaria", "Patella aspera"))
#Visualizacion de diferencia entre tallas
ggplot(Mad_2sp, aes(x = species, y = total_length_mm)) +
geom_boxplot() +
theme_minimal()
#Visualizacion de diferencia entre tallas
ggplot(Mad_2sp, aes(x = species, y = weight_g)) +
geom_boxplot() +
theme_minimal()
shapiro.test(Mad_2sp$total_length_mm[Mad_2sp$species == "Patella aspera"])
shapiro.test(Mad_2sp$total_length_mm[Mad_2sp$species == "Patella aspera"])
#Visualizacion de diferencia entre tallas
ggplot(Mad_2sp, aes(x = species, y = total_length_mm, group = protective_regime)) +
geom_boxplot() +
theme_minimal()
#Visualizacion de diferencia entre tallas
ggplot(Mad_2sp, aes(x = species, y = total_length_mm, color = protective_regime)) +
geom_boxplot() +
theme_minimal()
#Visualizacion de diferencia entre tallas
ggplot(Mad_2sp, aes(x = species, y = weight_g, color=protective_regime)) +
geom_boxplot() +
theme_minimal()
ggplot(Mad_2sp, aes(x = total_length_mm, y = weight_g, color=protective_regime)) +
geom_boxplot() +
theme_minimal()
ggplot(Mad_2sp, aes(x = total_length_mm, y = weight_g, color=protective_regime)) +
geom_point() +
theme_minimal()
ggplot(Mad_2sp, aes(x = total_length_mm, y = age_lt, color=protective_regime)) +
geom_point() +
theme_minimal()
ggplot(Mad_2sp, aes(x = total_length_mm, y = age_lt, color=protective_regime)) +
geom_point() +
theme_minimal() +
facet_wrap(~species)
ggplot(Mad_2sp, aes(x = total_length_mm, y = age_lt, color=protective_regime)) +
geom_density() +
theme_minimal() +
facet_wrap(~species)
ggplot(Mad_2sp, aes(x = total_length_mm, y = age_lt, color=protective_regime)) +
geom_bar() +
theme_minimal() +
facet_wrap(~species)
ggplot(Mad_2sp, aes(x = total_length_mm, y = age_lt, color=protective_regime)) +
geom_col() +
theme_minimal() +
facet_wrap(~species)
ggplot(Mad_2sp, aes(x = total_length_mm, y = age_lt, color=protective_regime)) +
geom_col() +
theme_minimal() +
facet_wrap(~species)
ggplot(Mad_2sp, aes(x = total_length_mm, y = age_lt, color=protective_regime)) +
geom_col() +
theme_minimal() +
facet_wrap(~sampling_site)
ggplot(Mad_2sp, aes(x = total_length_mm, y = age_lt, color=protective_regime)) +
geom_density() +
theme_minimal() +
facet_wrap(~sampling_site)
ggplot(Mad_2sp, aes(x = total_length_mm, y = age_lt, color=protective_regime)) +
geom_density() +
theme_minimal() +
facet_wrap(~sampling_site)
ggplot(Mad_2sp, aes(x = protective_regime, y = age_lt, color=protective_regime)) +
geom_boxplot() +
theme_minimal() +
facet_wrap(~sampling_site)
ggplot(Mad_2sp, aes(x = protective_regime, y = age_lt, color=protective_regime)) +
geom_boxplot() +
theme_minimal()
ggplot(Mad_2sp, aes(x = protective_regime, y = log(age_lt), color=protective_regime)) +
geom_boxplot() +
theme_minimal()
ggplot(Mad_2sp, aes(x = protective_regime, y = log(age_month), color=protective_regime)) +
geom_boxplot() +
theme_minimal()
ggplot(Mad_2sp, aes(x = protective_regime, y = log(age_months), color=protective_regime)) +
geom_boxplot() +
theme_minimal()
ggplot(Mad_2sp, aes(x = protective_regime, y = age_months, color=protective_regime)) +
geom_boxplot() +
theme_minimal()
ggplot(Mad_2sp, aes(x = total_length_mm, y = weight_g, color=protective_regime)) +
geom_point() +
theme_minimal()
ggplot(Mad_2sp, aes(x = total_length_mm, y = weight_g, color=protective_regime)) +
geom_point() +
theme_minimal()+
facet_wrap(~species)
ggplot(Mad_2sp, aes(x =weight_g, y =total_length_mm , color=protective_regime)) +
geom_point() +
theme_minimal()+
facet_wrap(~species)
ggplot(Mad_2sp, aes(x = weight_g, y = ln(total_length_mm) , color=protective_regime)) +
geom_point() +
theme_minimal()+
facet_wrap(~species)
ggplot(Mad_2sp, aes(x = weight_g, y = log2(total_length_mm) , color=protective_regime)) +
geom_point() +
theme_minimal()+
facet_wrap(~species)
ggplot(Mad_2sp, aes(x = weight_g, y = total_length_mm , color=protective_regime)) +
geom_point() +
theme_minimal()+
facet_wrap(~species)
ggplot(Mad_2sp, aes(x = weight_g, y = total_length_mm , color=accesibility)) +
geom_point() +
theme_minimal()+
facet_wrap(~species)
ggplot(Mad_2sp, aes(x = weight_g, y = total_length_mm , color=accessibility)) +
geom_point() +
theme_minimal()+
facet_wrap(~species)
#Databases
Mad_RAW <- read_excel("Madeira/BD_LIMPETS_MAD_1996-2018.xlsx",
sheet = "Data", range = "A1:T69707")
Mad_RAW_Clean <- Mad_RAW %>% clean_names() #Arregla el formato de los nombre de las variables
names(Mad_RAW_Clean)
Mad_selected <- dplyr::select(Mad_RAW_Clean,
species, year, month, total_length_mm, total_length_class_mm,
weight_g,mature_imature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class) %>%
mutate(across(where(is.character), as.factor))
summary(Mad_selected)
#Databases
Mad_RAW <- read_excel("Madeira/BD_LIMPETS_MAD_1996-2018.xlsx",
sheet = "Data", range = "A1:T69707")
Mad_RAW_Clean <- Mad_RAW %>% clean_names() #Arregla el formato de los nombre de las variables
names(Mad_RAW_Clean)
Mad_selected <- dplyr::select(Mad_RAW_Clean,
species, year, month, total_length_mm, total_length_class_mm,
weight_g,mature_imature, sampling_site, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class) %>%
mutate(across(where(is.character), as.factor))
Mad_selected <- dplyr::select(Mad_RAW_Clean,
species, year, month, total_length_mm, total_length_class_mm,
weight_g,mature_imature, sampling_site,lat,long, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class) %>%
mutate(across(where(is.character), as.factor))
names(Mad_RAW_Clean)
Mad_selected <- dplyr::select(Mad_RAW_Clean,
species, year, month, total_length_mm, total_length_class_mm,
weight_g,mature_imature, sampling_site,lat,long, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class) %>%
mutate(across(where(is.character), as.factor))
summary(Mad_selected)
Mad_2sp <- Mad_selected %>%
filter(!is.na(sampling_site),species %in% c("Patella ordinaria", "Patella aspera"))
#Visualizacion de diferencia entre tallas
ggplot(Mad_2sp, aes(x = species, y = total_length_mm, color = protective_regime)) +
geom_boxplot() +
theme_minimal()
#Visualizacion de diferencia entre tallas
ggplot(Mad_2sp, aes(x = species, y = weight_g, color=protective_regime)) +
geom_boxplot() +
theme_minimal()
ggplot(Mad_2sp, aes(x = weight_g, y = total_length_mm , color=accessibility)) +
geom_point() +
theme_minimal()+
facet_wrap(~species)
Mad_2sp <- Mad_selected %>%
filter(!is.na(sampling_site),species %in% c("Patella ordinaria", "Patella aspera"))
#Visualizacion de diferencia entre tallas
ggplot(Mad_2sp, aes(x = species, y = total_length_mm, color = protective_regime)) +
geom_boxplot() +
theme_minimal()
#Visualizacion de diferencia entre tallas
ggplot(Mad_2sp, aes(x = species, y = weight_g, color=protective_regime)) +
geom_boxplot() +
theme_minimal()
ggplot(Mad_2sp, aes(x = weight_g, y = total_length_mm , color=accessibility)) +
geom_point() +
theme_minimal()+
facet_wrap(~species)
ggplot(Mad_2sp, aes(x = weight_g, y = total_length_mm , color=accessibility,is.na=FALSE)) +
geom_point() +
theme_minimal()+
facet_wrap(~species)
Mad_2sp <- Mad_selected %>%
filter(!is.na(sampling_site),species %in% c("Patella ordinaria", "Patella aspera"))
summary(Mad_2sp)
#Maps
# Crear copia de trabajo
coords <- Mad_2sp_site %>%
select(sampling_site, lat, long) %>%
distinct() %>%
drop_na(lat, long)
Mad_2sp <- Mad_selected %>%
filter(species %in% c("Patella ordinaria", "Patella aspera")) %>%
Mad_2sp_site <- Mad_2sp %>%
filter(!is.na(sampling_site) & trimws(sampling_site) != "")
Mad_2sp <- Mad_selected %>%
filter(species %in% c("Patella ordinaria", "Patella aspera")) %>%
Mad_2sp_site <- Mad_2sp %>%
filter(!is.na(sampling_site) & trimws(sampling_site) != "")
Mad_2sp <- Mad_selected %>%
filter(species %in% c("Patella ordinaria", "Patella aspera")) %>%
Mad_2sp_site <- Mad_2sp %>%
filter(!is.na(sampling_site) & trimws(sampling_site) != "")
#Maps
# Crear copia de trabajo
coords <- Mad_2sp_site %>%
select(sampling_site, lat, long) %>%
distinct() %>%
drop_na(lat, long)
#Databases
Mad_RAW <- read_excel("Madeira/BD_LIMPETS_MAD_1996-2018.xlsx",
sheet = "Data", range = "A1:T69707")
Mad_RAW_Clean <- Mad_RAW %>% clean_names() #Arregla el formato de los nombre de las variables
Mad_selected <- dplyr::select(Mad_RAW_Clean,
species, year, month, total_length_mm, total_length_class_mm,
weight_g,mature_imature, sampling_site,lat,long, protective_regime,
proximity_human_settlements, accessibility,
age_lt, age_months, age_class) %>%
mutate(across(where(is.character), as.factor))
Mad_2sp <- Mad_selected %>%
filter(species %in% c("Patella ordinaria", "Patella aspera"))
sum(is.na(Mad_2sp$sampling_site))
sum(trimws(Mad_2sp$sampling_site) == "")
Mad_2sp_site <- Mad_2sp %>%
filter(!is.na(sampling_site) & trimws(sampling_site) != "")
#Maps
# Crear copia de trabajo
coords <- Mad_2sp_site %>%
select(sampling_site, lat, long) %>%
distinct() %>%
drop_na(lat, long)
#Maps
# Crear copia de trabajo
coords <- Mad_2sp_site %>%
dplyr::select(sampling_site, lat, long) %>%
distinct() %>%
drop_na(lat, long)
#Maps
# Crear copia de trabajo
coords <- Mad_2sp_site %>%
dplyr::select(sampling_site, lat, long) %>%
distinct() %>%
drop_na(lat, long)
# Separar latitud
coords <- coords %>%
separate(lat, into = c("lat_deg", "lat_min", "lat_sec_dir"), sep = "°|'|\"", remove = FALSE) %>%
mutate(lat_sec = as.numeric(gsub("[^0-9.]", "", lat_sec_dir)),
lat_dir = gsub("[0-9.]", "", lat_sec_dir),
lat_dd = as.numeric(lat_deg) + as.numeric(lat_min)/60 + lat_sec/3600,
lat_dd = ifelse(lat_dir == "S", -lat_dd, lat_dd))
# Separar longitud
coords <- coords %>%
separate(long, into = c("long_deg", "long_min", "long_sec_dir"), sep = "°|'|\"", remove = FALSE) %>%
mutate(long_sec = as.numeric(gsub("[^0-9.]", "", long_sec_dir)),
long_dir = gsub("[0-9.]", "", long_sec_dir),
long_dd = as.numeric(long_deg) + as.numeric(long_min)/60 + long_sec/3600,
long_dd = ifelse(long_dir == "W", -long_dd, long_dd))
#Madeira map
ggplot() +
borders("world", xlim = c(-18, -15), ylim = c(31.5, 33.5), fill = "gray90", colour = "gray40") +
geom_point(data = coords, aes(x = long_dd, y = lat_dd, color = sampling_site), size = 3) +
theme_minimal() +
labs(title = "Sampling Sites in Madeira Archipelago",
x = "Longitude", y = "Latitude", color = "Sampling Site") +
theme(legend.position = "bottom")
library(stringr)
#Sampling Site Map
#Funcion para convertir dms a decimal
convert_dms_to_decimal <- function(dms) {
# Crear df de coordenadas
coords <- Mad_2sp_site %>%
dplyr::select(sampling_site, lat, long) %>%
distinct() %>%
drop_na(lat, long)
# Separar latitud
coords <- coords %>%
separate(lat, into = c("lat_deg", "lat_min", "lat_sec_dir"), sep = "°|'|\"", remove = FALSE) %>%
mutate(lat_sec = as.numeric(gsub("[^0-9.]", "", lat_sec_dir)),
lat_dir = gsub("[0-9.]", "", lat_sec_dir),
lat_dd = as.numeric(lat_deg) + as.numeric(lat_min)/60 + lat_sec/3600,
lat_dd = ifelse(lat_dir == "S", -lat_dd, lat_dd))
# Separar longitud
coords <- coords %>%
separate(long, into = c("long_deg", "long_min", "long_sec_dir"), sep = "°|'|\"", remove = FALSE) %>%
mutate(long_sec = as.numeric(gsub("[^0-9.]", "", long_sec_dir)),
long_dir = gsub("[0-9.]", "", long_sec_dir),
long_dd = as.numeric(long_deg) + as.numeric(long_min)/60 + long_sec/3600,
long_dd = ifelse(long_dir == "W", -long_dd, long_dd))
#Aplicar conversion de coordenadas
coords <- Mad_2sp_site %>%
dplyr::select(sampling_site, lat, long) %>%
distinct() %>%
drop_na(lat, long) %>%
mutate(
lat_dd = convert_dms_to_decimal(lat),
long_dd = convert_dms_to_decimal(long)
)
#Madeira map
ggplot() +
borders("world", xlim = c(-18, -15), ylim = c(31.5, 33.5), fill = "gray90", colour = "gray40") +
geom_point(data = coords, aes(x = long_dd, y = lat_dd, color = sampling_site), size = 3) +
theme_minimal() +
labs(title = "Sampling Sites in Madeira Archipelago",
x = "Longitude", y = "Latitude", color = "Sampling Site") +
theme(legend.position = "bottom")
# Función para convertir coordenadas DMS a decimal
convert_dms_to_decimal <- function(dms) {
parts <- str_match(dms, "(\\d+)°(\\d+)'(\\d+\\.?\\d*)\"?([NSEW])")
deg <- as.numeric(parts[,2])
min <- as.numeric(parts[,3])
sec <- as.numeric(parts[,4])
dir <- parts[,5]
decimal <- deg + min/60 + sec/3600
ifelse(dir %in% c("S", "W"), -decimal, decimal)
}
